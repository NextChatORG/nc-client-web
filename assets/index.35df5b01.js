import{a as c,G as r,j as e,T as I,d as S,r as u,a6 as U,U as Q,e as H,V as G,O as b,Q as B,B as f,a7 as V,n as D,a3 as Y,a8 as $,v as F,a9 as K,aa as W,M as J,x as X,ab as ee,a1 as ne,ac as te,K as re,ad as ie,ae as se,af as v,ag as ae,ah as ce,ai as le,aj as oe}from"./index.825b510e.js";import{E as de,D as ue}from"./Divider.8a357109.js";function he({layout:n="horizontal",name:i,value:s}){return c(r,{container:!0,alignItems:"center",direction:n==="horizontal"?"row":"column",justifyContent:n==="horizontal"?"space-between":void 0,spacing:4,children:[e(r,{item:!0,children:e(I,{withLetterSpacing:!0,fontWeight:500,children:i})}),e(r,{item:!0,children:e(I,{fontSize:14,children:s})})]})}function fe({color:n=S.color,size:i=S.size,...s}){return e("svg",{...s,height:i,viewBox:"0 0 48 48",width:i,xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M22.2 28.3h3.6v-6.5h6.5v-3.6h-6.5v-6.5h-3.6v6.5h-6.5v3.6h6.5ZM2.75 45.25V7.45q0-1.9 1.375-3.325Q5.5 2.7 7.45 2.7h33.1q1.9 0 3.325 1.425Q45.3 5.55 45.3 7.45v25.1q0 1.9-1.425 3.3t-3.325 1.4h-29.8Zm4.7-10.3 2.4-2.4h30.7V7.45H7.45Zm0-27.5v27.5Z",fill:n})})}function _e({color:n=S.color,size:i=S.size,...s}){return e("svg",{...s,height:i,viewBox:"0 0 48 48",width:i,xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M37.2 26.4v-6.2H31v-3.6h6.2v-6.2h3.6v6.2H47v3.6h-6.2v6.2Zm-18.95-3.1q-3.9 0-6.35-2.45-2.45-2.45-2.45-6.3 0-3.85 2.45-6.3 2.45-2.45 6.35-2.45 3.85 0 6.3 2.45Q27 10.7 27 14.55q0 3.85-2.45 6.3-2.45 2.45-6.3 2.45ZM.95 41.9v-6.05q0-2.1 1.1-3.8 1.1-1.7 3-2.6 3.85-1.7 6.925-2.4 3.075-.7 6.275-.7t6.275.7q3.075.7 6.825 2.4 1.9.9 3.025 2.575Q35.5 33.7 35.5 35.85v6.05Zm4.75-4.7h25.1v-1.15q0-.75-.425-1.45t-1.225-1.05q-3.3-1.55-5.65-2-2.35-.45-5.25-.45-2.85 0-5.275.475-2.425.475-5.675 1.975-.8.35-1.2 1.05-.4.7-.4 1.45Zm12.5-18.6q1.8 0 2.95-1.15 1.15-1.15 1.15-2.9 0-1.8-1.15-2.925Q20 10.5 18.25 10.5q-1.8 0-2.925 1.125Q14.2 12.75 14.2 14.55q0 1.75 1.125 2.9T18.2 18.6Zm.05-4.05Zm0 16.55Z",fill:n})})}const me="_profile__leftContent_1f4iw_1",ge="_profile__leftContent__action_1f4iw_6",pe="_profile__leftContent__username_1f4iw_13",x={profile__leftContent:me,profile__leftContent__action:ge,profile__leftContent__username:pe},L=12;function Ee({total:n,userId:i}){const[s,a]=u.exports.useState(!1),[q,E]=u.exports.useState([]),[_,R]=u.exports.useState(0),[T,{loading:h}]=U(V,{fetchPolicy:"network-only"});async function g(l){const{data:o}=await T({variables:{page:l,perPage:L,userId:i}});o!=null&&o.getFriends&&E(m=>Array.from(new Set(m.concat(o.getFriends))))}function C(){return(_+1)*(L+1)<n}function A(){a(!0),window.addEventListener("scroll",function(){if(!s)return;const{clientHeight:l,scrollHeight:o,scrollTop:m}=document.documentElement;m+l>=o-5&&C()&&(R(w=>w+1),g(_+1))},{passive:!0})}return u.exports.useEffect(()=>{g(0)},[]),u.exports.useEffect(()=>{a(!1),E([]),R(0),g(0)},[i]),c(Q,{children:[e(r,{container:!0,style:{marginBottom:24},children:c(I,{variant:"subtitle",children:["Amigos (",n,")"]})}),e(r,{container:!0,spacing:24,children:q.map((l,o)=>e(r,{item:!0,children:e(H,{to:G.replace(":username",l.username),children:c(r,{container:!0,alignItems:"center",direction:"column",spacing:6,children:[e(r,{item:!0,children:e(b,{url:l.profileImage})}),e(r,{item:!0,children:e(I,{withLetterSpacing:!0,children:l.username})})]})})},`profile_friend_${l.id}_${o}`))}),c(r,{container:!0,justifyContent:"center",children:[h&&e(B,{id:`profile-friends-${i}`,text:"Cargando..."}),!s&&!h&&C()&&e(f,{color:"white",onClick:A,size:"small",variant:"outlined",children:"Cargar m\xE1s"})]})]})}function Fe(){var P,N,y;const[n,i]=u.exports.useState(null),{data:s}=D(),{username:a}=Y(),q=$(),[E,{data:_,subscribeToMore:R}]=U(ie),[T,{data:h}]=U(se),[g,{loading:C}]=F(ae,{onCompleted({sendFriendRequest:d}){!d||i({...v,canUnSendFriendRequest:!0})}}),[A,{loading:l}]=F(ce,{onCompleted({cancelFriendRequest:d}){!d||i({...v,canSendFriendRequest:!0})}}),[o,{loading:m}]=F(le,{onCompleted({acceptFriendRequest:d}){!d||i({...v,canSendMessage:!0})}}),[w,{loading:M}]=F(oe,{onCompleted({declineFriendRequest:d}){!d||i({...v,canSendMessage:!0})}});function Z(){if(!(!(t!=null&&t.id)||!(n!=null&&n.canSendFriendRequest)))return g({variables:{userId:t.id}})}function k(){if(!(!(t!=null&&t.id)||!(n!=null&&n.canUnSendFriendRequest)))return A({variables:{userId:t.id}})}function z(){if(!(!(t!=null&&t.id)||!(n!=null&&n.canAcceptFriendRequest)))return o({variables:{userId:t.id}})}function j(){if(!(!(t!=null&&t.id)||!(n!=null&&n.canDeclineFriendRequest)))return w({variables:{userId:t.id}})}const p=a===(s==null?void 0:s.username),t=a?p?s:(P=_==null?void 0:_.getProfile)!=null?P:null:s;return u.exports.useEffect(()=>{a&&a.length>=4&&!p&&E({variables:{username:a}})},[a]),u.exports.useEffect(()=>{t!=null&&t.actions&&(i(K(t.actions)),p||T({variables:{userId:t.id}}))},[t]),u.exports.useEffect(()=>{a&&!p&&R({document:W,variables:{username:a},updateQuery(d,{subscriptionData:O}){return O.data?{getProfile:{...d.getProfile,actions:O.data.profileActionsChanged.actions}}:d}})},[]),c(J,{withHeader:!0,children:[q,t&&c(X,{children:[e(r,{item:!0,xs:3,children:c(Q,{className:x.profile__leftContent,children:[e("div",{className:x.profile__leftContent__action,children:c(r,{container:!0,justifyContent:"center",spacing:12,children:[e(r,{item:!0,children:n!=null&&n.canAcceptFriendRequest?e(f,{loading:m||M,onClick:z,size:"small",children:"Aceptar solicitud"}):null}),e(r,{item:!0,children:n!=null&&n.isMe?e(f,{link:!0,startIcon:e(de,{}),to:ee.replace(":username",t.username),children:"Editar perfil"}):(n==null?void 0:n.canSendMessage)&&(h==null?void 0:h.getChat)?e(f,{link:!0,startIcon:e(fe,{}),to:ne.replace(":chatId",h.getChat.id.toString()),children:"Enviar mensaje"}):n!=null&&n.canSendFriendRequest?e(f,{loading:C,onClick:Z,startIcon:e(_e,{}),children:"Enviar solicitud"}):n!=null&&n.canUnSendFriendRequest?e(f,{color:"error",loading:l,onClick:k,startIcon:e(te,{}),children:"Cancelar solicitud"}):n!=null&&n.canDeclineFriendRequest?e(f,{color:"error",loading:m||M,onClick:j,size:"small",children:"Rechazar solicitud"}):null})]})}),c(r,{container:!0,justifyContent:"center",spacing:24,children:[e(r,{item:!0,xs:12,children:c(r,{container:!0,alignItems:"center",direction:"column",spacing:12,children:[e(r,{item:!0,children:e(b,{size:"big",url:t.profileImage})}),e(r,{item:!0,children:e("span",{className:x.profile__leftContent__username,children:t.username})})]})}),e(r,{item:!0,xs:12,children:e(ue,{})}),e(r,{item:!0,xs:12,children:e(r,{container:!0,spacing:12,children:t.createdAt&&e(r,{item:!0,xs:12,children:e(he,{name:"Registro",value:re(new Date(t.createdAt),"MMMM yyyy")})})})})]})]})}),e(r,{item:!0,xs:9,children:e(Ee,{total:(y=(N=t.counters)==null?void 0:N.friends)!=null?y:0,userId:p?void 0:t.id})})]})]})}export{Fe as default};
