import{a,G as r,j as e,T as F,d as v,r as u,aa as x,U as b,e as H,V as G,O as y,Q as B,B as f,ab as V,n as D,a6 as Y,ac as $,v as R,ad as K,ae as W,M as J,x as X,af as ee,a4 as ne,ag as te,K as re,ah as ie,ai as se,aj as C,ak as ae,al as ce,am as le,an as oe}from"./index.8535afb5.js";import{E as de,D as ue}from"./Divider.546bda60.js";function he({layout:n="horizontal",name:i,value:s}){return a(r,{container:!0,alignItems:"center",direction:n==="horizontal"?"row":"column",justifyContent:n==="horizontal"?"space-between":void 0,spacing:4,children:[e(r,{item:!0,children:e(F,{withLetterSpacing:!0,fontWeight:500,children:i})}),e(r,{item:!0,children:e(F,{fontSize:14,children:s})})]})}function fe({color:n=v.color,size:i=v.size,...s}){return e("svg",{...s,height:i,viewBox:"0 0 48 48",width:i,xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M22.2 28.3h3.6v-6.5h6.5v-3.6h-6.5v-6.5h-3.6v6.5h-6.5v3.6h6.5ZM2.75 45.25V7.45q0-1.9 1.375-3.325Q5.5 2.7 7.45 2.7h33.1q1.9 0 3.325 1.425Q45.3 5.55 45.3 7.45v25.1q0 1.9-1.425 3.3t-3.325 1.4h-29.8Zm4.7-10.3 2.4-2.4h30.7V7.45H7.45Zm0-27.5v27.5Z",fill:n})})}function _e({color:n=v.color,size:i=v.size,...s}){return e("svg",{...s,height:i,viewBox:"0 0 48 48",width:i,xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M37.2 26.4v-6.2H31v-3.6h6.2v-6.2h3.6v6.2H47v3.6h-6.2v6.2Zm-18.95-3.1q-3.9 0-6.35-2.45-2.45-2.45-2.45-6.3 0-3.85 2.45-6.3 2.45-2.45 6.35-2.45 3.85 0 6.3 2.45Q27 10.7 27 14.55q0 3.85-2.45 6.3-2.45 2.45-6.3 2.45ZM.95 41.9v-6.05q0-2.1 1.1-3.8 1.1-1.7 3-2.6 3.85-1.7 6.925-2.4 3.075-.7 6.275-.7t6.275.7q3.075.7 6.825 2.4 1.9.9 3.025 2.575Q35.5 33.7 35.5 35.85v6.05Zm4.75-4.7h25.1v-1.15q0-.75-.425-1.45t-1.225-1.05q-3.3-1.55-5.65-2-2.35-.45-5.25-.45-2.85 0-5.275.475-2.425.475-5.675 1.975-.8.35-1.2 1.05-.4.7-.4 1.45Zm12.5-18.6q1.8 0 2.95-1.15 1.15-1.15 1.15-2.9 0-1.8-1.15-2.925Q20 10.5 18.25 10.5q-1.8 0-2.925 1.125Q14.2 12.75 14.2 14.55q0 1.75 1.125 2.9T18.2 18.6Zm.05-4.05Zm0 16.55Z",fill:n})})}const me="_profile__leftContent_1f4iw_1",ge="_profile__leftContent__action_1f4iw_6",pe="_profile__leftContent__username_1f4iw_13",U={profile__leftContent:me,profile__leftContent__action:ge,profile__leftContent__username:pe},Q=12;function Ee({total:n,userId:i}){const[s,c]=u.exports.useState(!1),[I,S]=u.exports.useState([]),[_,q]=u.exports.useState(0),[T,{loading:h}]=x(V);async function g(l){const{data:o}=await T({variables:{page:l,perPage:Q,userId:i}});o!=null&&o.getFriends&&S(m=>Array.from(new Set(m.concat(o.getFriends))))}function p(){return(_+1)*(Q+1)<n}function A(){c(!0),window.addEventListener("scroll",function(){if(!s)return;const{clientHeight:l,scrollHeight:o,scrollTop:m}=document.documentElement;m+l>=o-5&&p()&&(q(w=>w+1),g(_+1))},{passive:!0})}return u.exports.useEffect(()=>{g(0)},[]),a(b,{children:[e(r,{container:!0,style:{marginBottom:24},children:a(F,{variant:"subtitle",children:["Amigos (",n,")"]})}),e(r,{container:!0,spacing:24,children:I.map((l,o)=>e(r,{item:!0,children:e(H,{to:G.replace(":username",l.username),children:a(r,{container:!0,alignItems:"center",direction:"column",spacing:6,children:[e(r,{item:!0,children:e(y,{url:l.profileImage})}),e(r,{item:!0,children:e(F,{withLetterSpacing:!0,children:l.username})})]})})},`profile_friend_${l.id}_${o}`))}),a(r,{container:!0,justifyContent:"center",children:[h&&e(B,{id:`profile-friends-${i}`,text:"Cargando..."}),!s&&!h&&p()&&e(f,{color:"white",onClick:A,size:"small",variant:"outlined",children:"Cargar m\xE1s"})]})]})}function Fe(){var N,P,O;const[n,i]=u.exports.useState(null),{data:s}=D(),{username:c}=Y(),I=$(),[S,{data:_,subscribeToMore:q}]=x(ie),[T,{data:h}]=x(se),[g,{loading:p}]=R(ae,{onCompleted({sendFriendRequest:d}){!d||i({...C,canUnSendFriendRequest:!0})}}),[A,{loading:l}]=R(ce,{onCompleted({cancelFriendRequest:d}){!d||i({...C,canSendFriendRequest:!0})}}),[o,{loading:m}]=R(le,{onCompleted({acceptFriendRequest:d}){!d||i({...C,canSendMessage:!0})}}),[w,{loading:M}]=R(oe,{onCompleted({declineFriendRequest:d}){!d||i({...C,canSendMessage:!0})}});function Z(){if(!(!(t!=null&&t.id)||!(n!=null&&n.canSendFriendRequest)))return g({variables:{userId:t.id}})}function k(){if(!(!(t!=null&&t.id)||!(n!=null&&n.canUnSendFriendRequest)))return A({variables:{userId:t.id}})}function z(){if(!(!(t!=null&&t.id)||!(n!=null&&n.canAcceptFriendRequest)))return o({variables:{userId:t.id}})}function j(){if(!(!(t!=null&&t.id)||!(n!=null&&n.canDeclineFriendRequest)))return w({variables:{userId:t.id}})}const t=c?(N=_==null?void 0:_.getProfile)!=null?N:null:s,E=c===(s==null?void 0:s.username);return u.exports.useEffect(()=>{c&&c.length>=4&&!E&&S({variables:{username:c}})},[c]),u.exports.useEffect(()=>{t!=null&&t.actions&&(i(K(t.actions)),E||T({variables:{userId:t.id}}))},[t]),u.exports.useEffect(()=>{c&&!E&&q({document:W,variables:{username:c},updateQuery(d,{subscriptionData:L}){return L.data?{getProfile:{...d.getProfile,actions:L.data.profileActionsChanged.actions}}:d}})},[]),a(J,{withHeader:!0,children:[I,t&&a(X,{children:[e(r,{item:!0,xs:3,children:a(b,{className:U.profile__leftContent,children:[e("div",{className:U.profile__leftContent__action,children:a(r,{container:!0,justifyContent:"center",spacing:12,children:[e(r,{item:!0,children:n!=null&&n.canAcceptFriendRequest?e(f,{loading:m||M,onClick:z,size:"small",children:"Aceptar solicitud"}):null}),e(r,{item:!0,children:n!=null&&n.isMe?e(f,{link:!0,startIcon:e(de,{}),to:ee.replace(":username",t.username),children:"Editar perfil"}):(n==null?void 0:n.canSendMessage)&&(h==null?void 0:h.getChat)?e(f,{link:!0,startIcon:e(fe,{}),to:ne.replace(":chatId",h.getChat.id.toString()),children:"Enviar mensaje"}):n!=null&&n.canSendFriendRequest?e(f,{loading:p,onClick:Z,startIcon:e(_e,{}),children:"Enviar solicitud"}):n!=null&&n.canUnSendFriendRequest?e(f,{color:"error",loading:l,onClick:k,startIcon:e(te,{}),children:"Cancelar solicitud"}):n!=null&&n.canDeclineFriendRequest?e(f,{color:"error",loading:m||M,onClick:j,size:"small",children:"Rechazar solicitud"}):null})]})}),a(r,{container:!0,justifyContent:"center",spacing:24,children:[e(r,{item:!0,xs:12,children:a(r,{container:!0,alignItems:"center",direction:"column",spacing:12,children:[e(r,{item:!0,children:e(y,{size:"big",url:t.profileImage})}),e(r,{item:!0,children:e("span",{className:U.profile__leftContent__username,children:t.username})})]})}),e(r,{item:!0,xs:12,children:e(ue,{})}),e(r,{item:!0,xs:12,children:e(r,{container:!0,spacing:12,children:t.createdAt&&e(r,{item:!0,xs:12,children:e(he,{name:"Registro",value:re(new Date(t.createdAt),"MMMM yyyy")})})})})]})]})}),e(r,{item:!0,xs:9,children:e(Ee,{total:(O=(P=t.counters)==null?void 0:P.friends)!=null?O:0,userId:E?void 0:t.id})})]})]})}export{Fe as default};
